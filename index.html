<!DOCTYPE html>
<html >
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1,target-densitydpi=device-dpi" />
        <!--  width=device-width, height=device-height,  -->
     <script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>   

        <title>Fizz</title>
        <script src="js/socket.io.js"></script>
             <script type="text/javascript" src="cordova.js"></script>
  <script type="text/javascript" src="js/bootstrap.js"></script>
 
  <link type='text/css' href='css/bootstrap.css' rel='stylesheet' media='screen' />
    
<style>

    .circle {
  /* absolute position with 3d animation = render layer */
  position: absolute;
  
  border:3px solid transparent;
  border-top: 3px solid hsl(83, 82%, 53%);
  border-radius: 50%;
  
  /* shared animation */
  -webkit-animation: rotate linear infinite;
}

.circle.one {
  height: 50px;
  width: 50px;
  left:50px;
  top:50px;
  -webkit-animation-duration: 0.85s;
}

.circle.two {
  height: 75px;
  width: 75px;
  top: 38px;
  left: 38px;
  -webkit-animation-duration: 0.95s;
}

.circle.three {
  height: 100px;
  width: 100px;
  top: 25px;
  left: 25px;
  -webkit-animation-duration: 1.05s;
}

@-webkit-keyframes rotate {
  /* rotate on 3d transform for best perf, it ensures GPU accelerated animation */
  from {
    -webkit-transform: rotateZ(360deg);
  }
  to {
    -webkit-transform: rotateZ(0deg);
  }
}

.loader {
  position:absolute;
  top:50%;
  left:50%;
  margin:-90px 0 0 -90px;
}

body {
 
}</style> 
<div class="loader">
  <div class="circle one"></div>
  <div class="circle two"></div>
  <div class="circle three"></div>
</div>
 
 
<div id='container'>
 
 
<div class="modal" id="myModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
          <h4 class="modal-title">No Connection Found</h4>
        </div>
        <div class="modal-body">
           Please check you connection
        </div>
        <div class="modal-footer">
          
          <a href="#"   class="retry btn btn-primary">Retry</a>
        </div>
      </div>
    </div>
</div>
 
</div>
 
 

        <script type="text/javascript">
           
var app = {
    hosts : ['198.61.166.94:3080','live.peoplenook.com:3080','live.peoplenook.com','px.peoplenook.com:3000'],
    hostIndex : 0,
    // Application Constructor
    initialize: function() {
        this.bindEvents();
        this.findHost();
        this.timeoutModal();
    },
    timeoutModal : function(){
        setTimeout(function(){
         $('#myModal').modal({show:true})
            $('.retry').click(function(){
                 $('#myModal').modal('hide')
            })

        },10000);
    }
    ,
    findHost : function(){
           var self = this;
          console.log('find Host');
            if (this.hostIndex >=  this.hosts.length) 
                   this.hostIndex = 0;
                 this.connect(this.hosts[this.hostIndex ]);
                 setTimeout(function(){
                    self.hostIndex = self.hostIndex + 1;
                       self.findHost();

                 },3000);
            
        
      
    },
    // Bind Event Listeners
    //
    // Bind any events that are required on startup. Common events are:
    // 'load', 'deviceready', 'offline', and 'online'.
    bindEvents: function() {
        document.addEventListener('deviceready', this.onDeviceReady, false);
    },
    // deviceready Event Handler
    //
    // The scope of 'this' is the event. In order to call the 'receivedEvent'
    // function, we must explicity call 'app.receivedEvent(...);'
    onDeviceReady: function() {
 console.log('deviceReady');
          
   
},
    connect : function(url){
     
        console.log(url);
        $.getScript('http://'+url+'/assets/js/custom.js',function(){
              window.location = 'http://'+url;
        });

  

 
    },
    // Update DOM on a Received Event
    receivedEvent: function(id) {
        var parentElement = document.getElementById(id);
        var listeningElement = parentElement.querySelector('.listening');
        var receivedElement = parentElement.querySelector('.received');

        listeningElement.setAttribute('style', 'display:none;');
        receivedElement.setAttribute('style', 'display:block;');

        console.log('Received Event: ' + id);
    }
};
      
     $(function(){
     
       app.initialize();
//checkAndConnect('live.peoplenook.com:3080/');
   
    });
       
        </script>

</body>
</html>
